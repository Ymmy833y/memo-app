let sw=self,CACHE_NAME="memo-app-cache-v3",ASSET_MANIFEST="./parcel-manifest.json",CDN_URLS=["https://uicdn.toast.com/editor-plugin-code-syntax-highlight/latest/toastui-editor-plugin-code-syntax-highlight.min.css"];sw.addEventListener("install",e=>{e.waitUntil((async()=>{try{let e=await fetch("./parcel-manifest.json"),t=await e.json(),a=Object.values(t).map(e=>new URL(e,self.location.href).toString()),n=new URL("./index.html",self.location.href).toString();a.includes(n)||a.push(n);let s=[...a,...CDN_URLS],i=await caches.open(CACHE_NAME);await Promise.all(s.map(async e=>{let t=new URL(e);if("chrome-extension:"!==t.protocol)try{let t=e.startsWith("https://uicdn.toast.com/")?new Request(e,{mode:"no-cors"}):new Request(e),a=await fetch(t);await i.put(e,a)}catch(t){console.error(`[SW] Failed to cache ${e}:`,t)}}))}catch(e){console.error("[SW] Failed to load asset manifest:",e)}})())}),sw.addEventListener("activate",e=>{e.waitUntil((async()=>{let e=await caches.keys();await Promise.all(e.filter(e=>e!==CACHE_NAME).map(e=>caches.delete(e)))})())}),sw.addEventListener("fetch",e=>{let{request:t}=e,a=new URL(t.url);if(!t.url.includes("/ws")&&"chrome-extension:"!==a.protocol){if("navigate"===t.mode||["document","script","style"].includes(t.destination))return void e.respondWith((async()=>{try{let e=await fetch(t);return(await caches.open(CACHE_NAME)).put(t,e.clone()),e}catch{console.warn("[SW] Network fetch failed, falling back to cache:",t.url);let e=await caches.match(t);if(e)return e;if("navigate"===t.mode)return await caches.match(new URL("./index.html",self.location.href).toString());return new Response("",{status:503,statusText:"Service Unavailable"})}})());e.respondWith((async()=>{let e=await caches.match(t);if(e)return console.log("[SW] Serving cached:",t.url),e;try{return await fetch(t)}catch{return console.error("[SW] Fetch failed:",t.url),new Response("",{status:503,statusText:"Service Unavailable"})}})())}});
//# sourceMappingURL=sw.js.map
